# Malware-Detection-using-N-Gram-Frequency

## Introduction:
Malware(Malicious Software) refers to any softwre intentionally designed to cause damage to a computer, server, client, or computer networks. The commom Malware types, include(but not restricted to) Virus, Trojans, Spyware, Worms and Ransomware. A Malware can compromise computers/smart devices, steal confidential information, penetrate networks, and cripple critical infrastructure etc.
Realising the potential damage Malwares can cause, people resort to "Anti-Virus" softwares for protection.
A typical Anti-Virus(could be called as "Anti-Malware" also, although there are certain differences) software detects Malwares through the following ways:

**Signature Based Detection**:

Signatures are bytes of data or hashes of an object, that would uniquely identify the object. In computing, all objects have attributes that can be used to create a unique signature. When an anti-malware solution provider identifies an object as malicious, its signature is added to a database of known malware. These repositories may contain hundreds of millions of signatures that identify malicious objects. The IDS(Intrusion detection system) analyzes the packets travelling across the network and checks if it matches the signatute of a known malware. If match(es) is found, necessary actions are taken.

**Behavioural Based Detection**:

Behavior-based malware detection evaluates an object based on its intended actions before it can actually execute that behavior. Attempts to perform actions that are clearly abnormal or unauthorized would indicate the object is malicious, or at least suspicious. Some examples of suspicious behaviour/actions include attempt to discover a sandbox environment, disabling security controls, installing rootkits, and registering for autostart.

The Signature Based Detection has it own set of demerits. In order for it to identify a malware, it's signature should have already been present in the database. Attackers are using Novel Malwares, which Signature Based Detection systems fails to recognize. Thus this method does not protect us against Zero-Day Attacks. Although various organizations are setting up "Honeypots" across the globe to identify and study new Malwares, the volume of new Malwares emerging every day is just huge.

## The idea: 

* It has been mentioned earlier that Signature Based Detections is not effective against Zero-Day attacks. In this project, we'll analyse Opcodes and Instructions of Malware and Benign(Non Malware/ Unharmful) files and use Machine Learning to predict potential Malware.
* All Computer Programs/Applications are converted into Assemby Language before execution and that includes Malwares too.
* Upon manually analysing a few Malware and Benign files, some distinctive features are observed, which incude:
  1. It could be observed that on an average malware files tends to have more number of instructions/opcodes that involves packed values/data(example: andps,divps,pcmpeqd etc.).
  2. Many Malware files tend to contain more number of cryptographic hash functions like SHA256.
* Therefore, analysing the opcodes of malware and benign files could help in inidentifying potential malwares.
* Thus an attempt has been made to identify potential malwares by using a MachineLearning model that feeds on Opcode and Hexadecimal Instructions.

## Dataset Creation:

### Data Collection:
* The intent is to train a Machine Learning Model to classify Benign and Malware files.
* All the Malware and Benign files used in this project are Windows Executable Files/Applications.
* The Malware samples/files were downloaded from the following websites:
  1. https://virusshare.com/
  2. https://dasmalwerk.eu/
  3. http://www.tekdefense.com/downloads/malware-samples/
 * A total of 600 Malware files were downloaded from these sites. The Malware samples includes a vareity of Viruses, Trojans, Worms, Ransomware etc.
 * An Ubuntu Virtual Machine was set up and the Malwares were downloaded in the Virtual Machine. 
 * A total of 504 Windows Applications/Software were taken from my computer to be used as Benign files for the purpose of the project.
 
 ### Dataset Creation:
* The downloaded Malware files and the Benign files were disassembled in the Ubuntu Virtual Machine using the shell instruction “objdump –d <file name>” (This command will extract the Opcode Sequence of the executable section of the file). The output is then stored in a text file.
* These text files are converted into .csv files so as to facilitate easier data manipulation and processing through python pandas library.
* Samples of the Malware and Benign .txt and .csv files are uploaded in the github as well.
  
## Methods of Detection:
The following ways were used to feed the data into the Machine Learning Algoritms:
 1. Detection using Opcode Count with N-Grams=1.
 2. Detection using Opcode Count with N-Grams=2.
 3. Detection using Opcode Frequency with N-Grams=1.
 4. Detection using Opcode Frequency with N-Grams=2,
 5. Detection using Hexadecimal Instruction Count with N-Grams=1.
 6. Detection using Hexadecimal Instruction Count with N-Grams=2.
 7. Detection using Hexadecimal Instruction Frequency with N-Grams=1.
 8. Detection using Hexadecimal Instruction Frequency with N-Grams=2.
 
 Opcode Count: 
 
